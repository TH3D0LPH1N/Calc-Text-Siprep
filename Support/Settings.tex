% Package Imports + Core Setup

\usepackage{graphicx} % Required for inserting images
\usepackage{setspace} 
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{xpatch} 
\usepackage{ifthen}
\usepackage{etoolbox}
\usepackage{mathtools}
\usepackage[dvipsnames]{xcolor}
\usepackage[table]{xcolor}
\usepackage[most]{tcolorbox}
\usepackage{lmodern}
\usepackage{datetime}
\usepackage{hyperref}
\usepackage{calc}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{enumitem}
\usepackage{siunitx}
\usepackage[skip=11pt plus1pt]{parskip}
\usepackage[left=3cm,right=3cm,top=3cm,bottom=3cm]{geometry}
\usepackage{xr} %Absolutely dependent on aux files!
\usepackage{refcount}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{pgfplots}

\everymath{\displaystyle}
\pagestyle{plain}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Commands and Macros

\let \templim \lim
\renewcommand{\lim}{\templim\limits}
\let\tempsi\si
\renewcommand{\si}[1]{\;\tempsi{#1}}
\renewcommand{\choicelabel}{\alph{choice})}
\newcommand{\horizontalline}{\noindent\makebox[\linewidth]{\rule{\textwidth}{1pt}}} 
\newcommand{\parthline}{\hspace{-17.5pt} \horizontalline}
\newcommand{\diff}{\dfrac{d}{dx}}
\newcommand{\tdiff}{\dfrac{d}{dt}}
\newcommand{\deriv}[1][]{%
    \ifthenelse{\equal{#1}{}}%
        {\dfrac{dy}{dx}}
        {\dfrac{d^{#1}y}{dx^{#1}}}
}
\newcommand{\forcespace}{\vphantom{\Bigg|}}
\newcommand{\smallforcespace}{\vphantom{\Big|}}
\newcommand{\eval}{\bigg|}
\newcommand{\bargap}{\quad \bigg| \quad}
\newcommand{\twoquestion}[2]{%
        \makebox[0.57\textwidth][l]{#1}%
        \makebox[0.43\textwidth][l]{#2}%
}
\newcommand{\onequestion}[1]{%
    \noindent\begin{minipage}{\textwidth}
        #1
    \end{minipage}\vspace{2pt}
}
\newcommand{\curvedarrow}{%
    \tikz[baseline=-0.5ex]{% <-- braces open
        \draw[->, rounded corners=1.5pt, line width=0.8pt]
            (0, 0.75ex) -- (0,-0.1 ex) -- (2.6ex,-0.1 ex);
    } \hspace{5.5pt}% <-- braces close
}

% Fixes

\DeclareMathOperator{\sgn}{sgn}

\bigskipamount = 154pt
\setlength{\tabcolsep}{11pt}

\newdateformat{fulldate}{\monthname[\THEMONTH]~\THEDAY, \THEYEAR}

\allowdisplaybreaks

\hbadness = 10000 %Hotfix
\xpatchcmd{\oneparchoices}{\penalty -50\hskip 1em plus 1em\relax}{\hfill}{}{}

\makeatletter
\xpatchcmd{\questions}
    {question@\arabic{question}}
    {question@chapter\arabic{chaptercount}section\arabic{sectioncount}question\arabic{question}@\arabic{question}}
    {}{}
\makeatother

\makeatletter
\xpatchcmd{\parts}
    {part@} 
    {part@chapter\arabic{chaptercount}section\arabic{sectioncount}question\arabic{question}part} % <--- Patch just the start
\makeatother


% Page Numbering Settings

\newcounter{sectioncount}
\newcounter{chaptercount}
\setcounter{page}{0}

% Tcolorbox Presets

\tcbset{example/.style={colback=Cyan!25, colframe=Gray!70, breakable, enhanced jigsaw, arc=0.5mm}}
\tcbset{solution/.style={colback=Green!20, colframe=Gray!70, breakable, enhanced jigsaw, arc=0.5mm}}
\tcbset{objective/.style={colback=Gray!20, colframe=Black, arc=0.5mm, boxrule=0.5pt}}
\tcbset{definition/.style={colback=Goldenrod!20, colframe=Gray!70, breakable, enhanced jigsaw, arc=0.5mm}}
\tcbset{interesting/.style={colback=WildStrawberry!40, colframe=Gray!70, breakable, enhanced jigsaw, arc=0.5mm}}
\tcbset{default/.style={colback=White, colframe=Black, arc=0.5mm}}

% TikzImage Settings

\usetikzlibrary{shapes.geometric, arrows.meta, positioning, decorations.pathreplacing, backgrounds}

\tikzstyle{startstop} = [rectangle, rounded corners, minimum width=0.99\textwidth, minimum height=1cm,text centered, draw=black, fill=WildStrawberry!50!white]
\tikzstyle{process} = [rectangle, minimum width=3cm, minimum height=1cm, text centered, text width=5cm, draw=black, fill=Green!50!white]
\tikzstyle{decision} = [diamond, minimum width=3cm, aspect=2.5, text centered, draw=black, fill=Cyan!30!white]
\tikzstyle{arrow} = [thick,->,>=stealth]
\tdplotsetmaincoords{60}{120}

% PGFPLOT Settings
\pgfplotsset{compat=1.18}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
